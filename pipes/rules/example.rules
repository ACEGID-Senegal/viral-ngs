import re, os, sys

rule split:
    input: 'test.txt'
    output: dynamic('prefix{split_id}.txt')
    params: LSF="-W 4:00"
    run:
        shell("split -l 2 {input} prefix")
        for f in os.listdir(os.getcwd()):
            if re.search('prefix[a-z][a-z]', f):
                os.rename(f, f + '.txt')

rule reordered:
    input: 'prefix{split_id,[a-z][a-z]}.txt'
    output: '{split_id}_reordered.txt'
    params: LSF="-q week"
    shell: "python reorder.py -i {input} -o {output}"

rule merge:
    input: dynamic('{split_id}_reordered.txt')
    output: 'out.txt'
    params: LSF=""
    shell: "cat {input} > {output}"
